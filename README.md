# TOFL: Time Optimized Federated Learning


This repository contains the code developed for SBSeg 2025. The code is composed by three parts. The first part simulates vehicles mobility, to extract this pattern to estimate the user delays, on the second part, using 5G technology. Finally, the third part simulates the federated learning training, given the latency values obtained during the first and second parts. The object is to test different client selection strategies in a scenario with mobility.

# Considered Stamps

We consider to be able to get all 4 stamps of the conference.

# Dependencies 

Conda is the only dependecy that you need to install in order to execute the framework [1]. All the other dependencies are going to be downloaded with the provided scripts.

## Get conda installer

```bash
 wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
```

## Change the permissions

```bash
 chmod +x Miniconda3-latest-Linux-x86_64.sh
```

## Execute the installation

```bash
 ./Miniconda3-latest-Linux-x86_64.sh
```

# Minimum Requirement

- SO: Ubuntu 22.04.5 LTS
- Cores: 4
- Memory: 4 GB


# Installation

Install the requirements:

```bash
 source scripts/create_paths.sh
 source scripts/create_env.sh
```

Create the necessary paths and download datasets:
 
```bash
 source scripts/download_datasets.sh
 source scripts/install_dependencies.sh
```

# Execution

We consider that the minimun test is to reproduce the figures on the paper. Therefore, we provide a simplified execution, which takes the data generated by our code. However, to test from the scracth we also provide a guide to do the complete execution, which takes a long time to generate all the requirements.

## Simplified execution

To reproduce the paper's experiments and reduce the execution time, download the data previously generated. This data contains mobility traces and communication conditions generated with SUMO and the communication model respectively. The total size of all files is up to 200 GB.

## Complete execution

Create SUMOs' trips: 
 
```bash
 source scripts/generate_trips.sh
```

Process the trips:

```bash
 python process_results/processed_mobility.py
```

Generate raw communication:
 
```bash
 source scripts/raw_communication.sh
```

Generate processed communication:

```bash
 source scripts/processed_communication.sh
```

Generate delays results:

```bash
 python src/main.py
 python process_results/aggregate_individual_results.py
 python process_results/process_epoch.py
```

# Federated Learning Training


## Generate Figures

Training time figure: 

```bash
 python generate_figures/communication.py
```

Epoch time figure: 

```bash
 python generate_figures/epoch_delays.py
```

Energy figure: 

```bash
 python generate_figures/energy.py
```

# LICENSE

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

